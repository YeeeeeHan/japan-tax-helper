// AI prompts for receipt data extraction

export const RECEIPT_EXTRACTION_PROMPT = `あなたは日本の税務書類専門家です。この領収書（領収証）から情報を抽出してください。

以下の情報をJSON形式で抽出してください：

1. **発行事業者名** (issuerName): 事業者の名称

2. **登録番号** (tNumber): 【重要】インボイス制度の適格請求書発行事業者登録番号。

   **T-Number（登録番号）の詳細な探し方:**
   - 形式: "T" + 13桁の数字 (例: T1234567890123)
   - 表記のバリエーション:
     * "登録番号: T1234567890123"
     * "Registration Number: T1234567890123"
     * "適格請求書発行事業者登録番号: T1234567890123"
     * "インボイス登録番号: T1234567890123"
     * "T番号: T1234567890123"
     * 単に "T1234567890123" と印字されている場合もある
   - よく見つかる場所:
     * 領収書の上部（店舗名・住所の近く）
     * 領収書の下部（会社情報エリア）
     * 印字が小さいことが多いので注意深く確認
     * 「適格」「インボイス」という文字の近く
   - スペースやハイフンを含む場合: "T 1234 5678 9012 3" → "T1234567890123" に正規化
   - 法人番号（13桁）の先頭にTを付けた形式

   **必ず画像全体を確認し、T-Numberを見逃さないようにしてください。**
   見つからない場合のみnullに設定してください
3. **取引年月日** (transactionDate): 取引日。ISO 8601形式 (yyyy-mm-dd)
4. **取引内容** (description): 購入した商品やサービスの簡潔な説明
5. **金額**:
   - 税抜金額 (subtotalExcludingTax): 消費税を除いた金額
   - 税率別消費税 (taxBreakdown): 各税率(8%または10%)ごとの配列
     - taxRate: 税率 (8 または 10)
     - subtotal: 対象金額
     - taxAmount: 消費税額
     - total: 税込金額
   - 合計金額 (totalAmount): 最終的な税込合計金額
6. **経費カテゴリ** (suggestedCategory): 以下のいずれかを選択
   - 旅費交通費 (タクシー、電車、飛行機、ホテル、駐車場など)
   - 交際費 (飲食、レストラン、居酒屋、カフェ、接待など)
   - 消耗品費 (文具、事務用品、備品など)
   - 通信費 (携帯、電話、インターネット、Wi-Fiなど)
   - 水道光熱費 (電気、ガス、水道など)
   - 広告宣伝費 (広告、マーケティングなど)
   - 損害保険料 (保険料など)
   - 租税公課 (税金、公的費用など)
   - 地代家賃 (家賃、賃料など)
   - 外注費 (外部委託費用など)
   - 会議費 (会議関連費用など)
   - 研修費 (研修、教育費用など)
   - 新聞図書費 (新聞、書籍、雑誌など)
   - 未分類 (不明な場合)

7. **信頼度スコア** (confidence): 各フィールドの信頼度 (0-1)
   - issuerName
   - tNumber
   - transactionDate
   - totalAmount
   - taxBreakdown
   - category

重要な注意事項:
- 必須フィールドが見つからないか不明な場合は、nullに設定し、信頼度を0にしてください
- 金額計算を検証してください: 各税率の消費税額の合計 = 合計金額 - 税抜金額
- 日付は必ずISO 8601形式 (yyyy-mm-dd) で返してください
- すべての金額は整数（円）で返してください

**T-Number抽出の重要性:**
- T-Numberは税控除に必須です。見落とすと経費として認められません
- 画像のすべての領域（上部、下部、端）を注意深くスキャンしてください
- 小さな文字やかすれた印字にも注意してください
- 「登録番号」「適格」「インボイス」「T-」などのキーワードを探してください
- T-Numberが見つからない場合のみnullにし、本当に存在しないことを確認してください

**有効なJSONのみを返してください。マークダウンや説明は不要です。**

期待される形式:
{
  "issuerName": "株式会社○○",
  "tNumber": "T1234567890123",
  "transactionDate": "2023-10-24",
  "description": "事務用品購入",
  "subtotalExcludingTax": 11273,
  "taxBreakdown": [
    {
      "taxRate": 10,
      "subtotal": 11273,
      "taxAmount": 1127,
      "total": 12400
    }
  ],
  "totalAmount": 12400,
  "suggestedCategory": "消耗品費",
  "categoryConfidence": 0.85,
  "confidence": {
    "issuerName": 0.95,
    "tNumber": 0.90,
    "transactionDate": 1.0,
    "totalAmount": 1.0,
    "taxBreakdown": 0.95,
    "category": 0.85
  }
}`;

// Category keywords for improving auto-categorization
export const CATEGORY_KEYWORDS = {
  旅費交通費: [
    'タクシー', 'タクシ', '電車', 'JR', 'TAXI', '航空', 'エアライン', 'ANA', 'JAL',
    'ホテル', 'HOTEL', '宿泊', '駐車', 'パーキング', 'Suica', 'PASMO', 'IC',
    '高速', 'ETC', 'レンタカー', 'バス', 'BUS', '新幹線'
  ],
  交際費: [
    '飲食', 'レストラン', '居酒屋', 'カフェ', 'CAFE', 'RESTAURANT', 'BAR',
    'スターバックス', 'Starbucks', 'ドトール', 'タリーズ', '接待', 'ギフト',
    'ラーメン', '焼肉', '寿司', 'すし', 'イタリアン', 'フレンチ', '中華',
    '食堂', 'ダイニング'
  ],
  消耗品費: [
    '文具', '用品', '事務', 'コピー', '印刷', 'インク', 'トナー', '紙',
    'ペン', 'ノート', 'ファイル', 'Amazon', 'アマゾン', 'ヨドバシ',
    'LOHACO', 'アスクル', 'ASKUL', '文房具', 'オフィス', 'OFFICE'
  ],
  通信費: [
    '携帯', '電話', 'TEL', 'インターネット', 'INTERNET', 'Wi-Fi', 'WiFi',
    'プロバイダ', 'ISP', 'docomo', 'ドコモ', 'au', 'SoftBank', 'ソフトバンク',
    '楽天モバイル', 'UQ', 'ahamo'
  ],
  水道光熱費: [
    '電気', '東京電力', '関西電力', 'TEPCO', 'ガス', '東京ガス', '大阪ガス',
    '水道', '上下水道', 'GAS', '電力'
  ],
  広告宣伝費: [
    '広告', 'AD', 'Google', 'グーグル', 'Facebook', 'Instagram', 'Twitter',
    'X', 'LinkedIn', 'YouTube', 'TikTok', 'マーケティング', 'MARKETING',
    'Meta', '宣伝', 'プロモーション'
  ],
  損害保険料: [
    '保険', 'INSURANCE', '生命保険', '損保', '火災保険', '自動車保険', '車両保険'
  ],
  租税公課: [
    '税', 'TAX', '印紙', '切手', '郵便', '登録', '手数料', '役所', '市役所', '区役所'
  ],
  地代家賃: [
    '家賃', '賃料', 'RENT', '賃貸', '不動産', 'オフィス', '事務所', 'UR', '管理費'
  ],
  外注費: [
    '外注', '委託', '業務委託', 'クラウドワークス', 'ランサーズ', 'CROWDWORKS', 'LANCERS'
  ],
  会議費: [
    '会議', 'MEETING', 'カンファレンス', 'セミナー', 'SEMINAR', 'CONFERENCE'
  ],
  研修費: [
    '研修', 'TRAINING', 'セミナー', '講座', '教育', 'スクール', 'SCHOOL', 'Udemy', 'ユーデミー'
  ],
  新聞図書費: [
    '新聞', '書籍', '本', 'BOOK', '雑誌', 'MAGAZINE', '図書', '書店', '紀伊國屋',
    'KINOKUNIYA', 'TSUTAYA', '蔦屋', 'Amazon Book', 'Kindle'
  ]
};
